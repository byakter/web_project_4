!function(){"use strict";function e(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{constructor(t,s,n){let{name:i,link:r}=t;e(this,"_handleLikeButton",(e=>{e.target.classList.toggle("cards__button-like_active")})),e(this,"_setEventListeners",(()=>{const e=this._cardElement.querySelector(".cards__button-like"),t=this._cardElement.querySelector(".cards__button-trash"),s=this._cardElement.querySelector(".cards__image");s.style.backgroundImage=`url(${this._link})`,this._cardElement.querySelector(".cards__title").textContent=this._name,e.addEventListener("click",this._handleLikeButton),t.addEventListener("click",(function(e){e.target.closest(".cards__card").remove()})),s.addEventListener("click",(()=>{this._handlerCardClick(this._name,this._link)}))})),e(this,"generateCard",(()=>(this._cardElement=this._cardTemplate.cloneNode(!0),this._setEventListeners(),this._cardElement))),this._name=i,this._link=r,this._templateCardSelector=s,this._handlerCardClick=n,this._cardTemplate=document.querySelector(s).content.querySelector(".cards__card")}}function s(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var n=class{constructor(e,t){s(this,"_showInputError",((e,t)=>{const{inputErrorClass:s,errorClass:n}=this.settings,i=this.formElement.querySelector(`#${e.id}-error`);i.textContent=t,i.classList.add(n),e.classList.add(s)})),s(this,"_hideInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this.settings,n=this.formElement.querySelector(`#${e.id}-error`);n.textContent="",n.classList.remove(s),e.classList.remove(t)})),s(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),s(this,"_setEventListeners",(()=>{const{inputSelector:e}=this.settings;this.inputList=[...this.formElement.querySelectorAll(e)],this.inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))})),s(this,"_isValid",(()=>this.inputList.every((e=>e.validity.valid)))),s(this,"_toggleButtonState",(()=>{const{inactiveButtonClass:e,submitButtonSelector:t}=this.settings,s=this.formElement.querySelector(t);this._isValid()?(s.disabled=!1,s.classList.remove(e)):(s.disabled="disabled",s.classList.add(e))})),this.settings=e,this.formElement=t}resetValidation(){this.inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}enableValidation(){this.formElement.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners(this.settings,this.formElement)}};class i{constructor(e){this._popup=document.querySelector(e),this.close=this.close.bind(this),this.closeByEscape=this.closeByEscape.bind(this),this._link=""}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this.closeByEscape)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this.closeByEscape)}setEventListeners(){this._popup.addEventListener("click",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&this.close()}))}closeByEscape(e){"Escape"===e.key&&this.close()}}class r extends i{constructor(e,t){super(e),this._submithandler=t,this._form=this._popup.querySelector(".popup__form")}_getInputValues(){const e={};return[...this._form.querySelectorAll(".popup__input")].forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submithandler(this._getInputValues()),this.close()})),super.setEventListeners()}close(){this._form.reset(),super.close()}}const o={inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function a(e){return new t(e,".card-template",E).generateCard()}const l=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}render(){this._items.forEach((e=>{this._renderer(e)}))}appendItem(e){this._container.append(e)}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:e=>{l.appendItem(a(e))}},".cards");l.render();const c=new class{constructor(e){let{profileNameSelector:t,profileJobSelector:s}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._profileName.textContent=t,this._profileJob.textContent=s}}({profileNameSelector:".profile__title",profileJobSelector:".profile__subtitle"}),p=new class extends i{open(e,t){const s=this._popup.querySelector(".popup__preview-title"),n=this._popup.querySelector(".popup__preview-image");s.textContent=e,n.src=t,n.alt="Image of selected tile",this._link=t,super.open()}}(".popup_type_preview");p.setEventListeners();const u=new r(".popup_type_profile",(e=>c.setUserInfo(e)));u.setEventListeners();const d=new r(".popup_type_card",(e=>{const t=a({name:e["place-name"],link:e.link});l.addItem(t)}));d.setEventListeners();const _=document.querySelector(".popup__form_type_profile"),h=document.querySelector(".popup__form_type_card"),m=new n(o,_),f=new n(o,h);m.enableValidation(),f.enableValidation();const y=document.querySelector(".profile__edit-button"),v=document.querySelector(".popup__input_type_name"),b=document.querySelector(".popup__input_type_profession");function E(e,t){p.open(e,t)}y.addEventListener("click",(function(){const e=c.getUserInfo();u.open(),m.resetValidation(),v.value=e.name,b.value=e.job})),document.querySelector(".profile__button").addEventListener("click",(function(){d.open(),f.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoiK2JBQ08sTUFBTUEsRUFDWEMsWUFBWSxFQUFnQkMsRUFBc0JDLEdBQWtCLElBQXhELEtBQUVDLEVBQUksS0FBRUMsR0FBTSw4QkFZTEMsSUFDbkJBLEVBQUVDLE9BQU9DLFVBQVVDLE9BQU8sNEJBQTRCLElBQ3ZELDZCQUVvQixLQUNuQixNQUFNQyxFQUFhQyxLQUFLQyxhQUFhQyxjQUFjLHVCQUM3Q0MsRUFBY0gsS0FBS0MsYUFBYUMsY0FBYyx3QkFDOUNFLEVBQWNKLEtBQUtDLGFBQWFDLGNBQWMsaUJBRXBERSxFQUFZQyxNQUFNQyxnQkFBbUIsT0FBTU4sS0FBS08sU0FDaERQLEtBQUtDLGFBQWFDLGNBQWMsaUJBQWlCTSxZQUFjUixLQUFLUyxNQUVwRVYsRUFBV1csaUJBQWlCLFFBQVNWLEtBQUtXLG1CQUUxQ1IsRUFBWU8saUJBQWlCLFNBQVMsU0FBVUUsR0FDM0JBLEVBQUloQixPQUFPaUIsUUFBUSxnQkFFM0JDLFFBQ2IsSUFFQVYsRUFBWU0saUJBQWlCLFNBQVMsS0FDcENWLEtBQUtlLGtCQUFrQmYsS0FBS1MsTUFBT1QsS0FBS08sTUFBTSxHQUM5QyxJQUNILHVCQUdjLEtBQ2JQLEtBQUtDLGFBQWVELEtBQUtnQixjQUFjQyxXQUFVLEdBRWxEakIsS0FBS2tCLHFCQUVHbEIsS0FBS0MsZ0JBMUNaRCxLQUFLUyxNQUFRaEIsRUFDYk8sS0FBS08sTUFBUWIsRUFDYk0sS0FBS21CLHNCQUF3QjVCLEVBQzdCUyxLQUFLZSxrQkFBb0J2QixFQUd6QlEsS0FBS2dCLGNBQWdCSSxTQUNsQmxCLGNBQWNYLEdBQ2Q4QixRQUFRbkIsY0FBYyxlQUMzQixFLHNhQ2lFRixNQTdFQSxNQUNFWixZQUFZZ0MsRUFBVUMsR0FBYSwwQkFPakIsQ0FBQ0MsRUFBT0MsS0FDeEIsTUFBTSxnQkFBRUMsRUFBZSxXQUFFQyxHQUFlM0IsS0FBS3NCLFNBRXZDTSxFQUFlNUIsS0FBS3VCLFlBQVlyQixjQUFlLElBQUdzQixFQUFNSyxZQUM5REQsRUFBYXBCLFlBQWNpQixFQUMzQkcsRUFBYS9CLFVBQVVpQyxJQUFJSCxHQUMzQkgsRUFBTTNCLFVBQVVpQyxJQUFJSixFQUFnQixJQUNyQywwQkFFa0JGLElBQ2pCLE1BQU0sZ0JBQUVFLEVBQWUsV0FBRUMsR0FBZTNCLEtBQUtzQixTQUV2Q00sRUFBZTVCLEtBQUt1QixZQUFZckIsY0FBZSxJQUFHc0IsRUFBTUssWUFDOURELEVBQWFwQixZQUFjLEdBQzNCb0IsRUFBYS9CLFVBQVVpQixPQUFPYSxHQUM5QkgsRUFBTTNCLFVBQVVpQixPQUFPWSxFQUFnQixJQUN4Qyw4QkFFc0JGLElBQ2pCQSxFQUFNTyxTQUFTQyxNQUNqQmhDLEtBQUtpQyxnQkFBZ0JULEdBRXJCeEIsS0FBS2tDLGdCQUFnQlYsRUFBT0EsRUFBTVcsa0JBQ3BDLElBQ0QsNkJBRW9CLEtBQ25CLE1BQU0sY0FBRUMsR0FBa0JwQyxLQUFLc0IsU0FFOUJ0QixLQUFLcUMsVUFBWSxJQUFJckMsS0FBS3VCLFlBQVllLGlCQUFpQkYsSUFFeERwQyxLQUFLcUMsVUFBVUUsU0FBU2YsSUFDdEJBLEVBQU1kLGlCQUFpQixTQUFTLEtBQzlCVixLQUFLd0Msb0JBQW9CaEIsR0FDekJ4QixLQUFLeUMsb0JBQW9CLEdBQ3pCLEdBQ0YsSUFDSCxtQkFFVSxJQUFNekMsS0FBS3FDLFVBQVVLLE9BQU9sQixHQUFVQSxFQUFNTyxTQUFTQyxVQUFNLDZCQUVqRCxLQUNuQixNQUFNLG9CQUFFVyxFQUFtQixxQkFBRUMsR0FBeUI1QyxLQUFLc0IsU0FDckR1QixFQUFlN0MsS0FBS3VCLFlBQVlyQixjQUFjMEMsR0FFaEQ1QyxLQUFLOEMsWUFDUEQsRUFBYUUsVUFBVyxFQUN4QkYsRUFBYWhELFVBQVVpQixPQUFPNkIsS0FFOUJFLEVBQWFFLFNBQVcsV0FDeEJGLEVBQWFoRCxVQUFVaUMsSUFBSWEsR0FDN0IsSUF6REEzQyxLQUFLc0IsU0FBV0EsRUFDaEJ0QixLQUFLdUIsWUFBY0EsQ0FDckIsQ0EwREF5QixrQkFDRWhELEtBQUtxQyxVQUFVRSxTQUFRZixJQUNyQnhCLEtBQUtpQyxnQkFBZ0JULEVBQU0sSUFFN0J4QixLQUFLeUMsb0JBQ1AsQ0FHQVEsbUJBQ0VqRCxLQUFLdUIsWUFBWWIsaUJBQWlCLFVBQVdmLEdBQU1BLEVBQUV1RCxtQkFFckRsRCxLQUFLa0IsbUJBQW1CbEIsS0FBS3NCLFNBQVV0QixLQUFLdUIsWUFDOUMsR0MxRUssTUFBTTRCLEVBQ1g3RCxZQUFZOEQsR0FDVnBELEtBQUtxRCxPQUFTakMsU0FBU2xCLGNBQWNrRCxHQUNyQ3BELEtBQUtzRCxNQUFRdEQsS0FBS3NELE1BQU1DLEtBQUt2RCxNQUM3QkEsS0FBS3dELGNBQWdCeEQsS0FBS3dELGNBQWNELEtBQUt2RCxNQUM3Q0EsS0FBS08sTUFBUSxFQUNmLENBQ0FrRCxPQUNFekQsS0FBS3FELE9BQU94RCxVQUFVaUMsSUFBSSxnQkFDMUJWLFNBQVNWLGlCQUFpQixVQUFZVixLQUFLd0QsY0FHN0MsQ0FFQUYsUUFDRXRELEtBQUtxRCxPQUFPeEQsVUFBVWlCLE9BQU8sZ0JBQzdCTSxTQUFTc0Msb0JBQW9CLFVBQVcxRCxLQUFLd0QsY0FDL0MsQ0FFQUcsb0JBQ0UzRCxLQUFLcUQsT0FBTzNDLGlCQUFpQixTQUFVRSxLQUVuQ0EsRUFBSWhCLE9BQU9DLFVBQVUrRCxTQUFTLFVBQzlCaEQsRUFBSWhCLE9BQU9DLFVBQVUrRCxTQUFTLGtCQUU5QjVELEtBQUtzRCxPQUNQLEdBRUosQ0FDQUUsY0FBYzVDLEdBQ0ksV0FBWkEsRUFBSWlELEtBQ043RCxLQUFLc0QsT0FFVCxFQzlCSyxNQUFNUSxVQUFzQlgsRUFDakM3RCxZQUFZeUUsRUFBZUMsR0FFekJDLE1BQU1GLEdBQ04vRCxLQUFLa0UsZUFBaUJGLEVBQ3RCaEUsS0FBS21FLE1BQVFuRSxLQUFLcUQsT0FBT25ELGNBQWMsZUFFekMsQ0FFQWtFLGtCQUNFLE1BQU1DLEVBQWMsQ0FBQyxFQVFyQixNQVBlLElBQUlyRSxLQUFLbUUsTUFBTTdCLGlCQUFpQixrQkFFeENDLFNBQVFmLElBQ1g2QyxFQUFZN0MsRUFBTS9CLE1BQVErQixFQUFNOEMsS0FBSyxJQUlsQ0QsQ0FDVCxDQUVBVixvQkFDRTNELEtBQUttRSxNQUFNekQsaUJBQWlCLFVBQVdmLElBQ3JDQSxFQUFFdUQsaUJBQ0ZsRCxLQUFLa0UsZUFBZWxFLEtBQUtvRSxtQkFDekJwRSxLQUFLc0QsT0FBTyxJQUdkVyxNQUFNTixtQkFDUixDQUVBTCxRQUVFdEQsS0FBS21FLE1BQU1JLFFBRVhOLE1BQU1YLE9BQ1IsRUNwQ0ssTUEyQlFoQyxFQUFXLENBQ3RCYyxjQUFlLGdCQUNmUSxxQkFBc0Isd0JBQ3RCRCxvQkFBcUIseUJBQ3JCakIsZ0JBQWlCLDBCQUNqQkMsV0FBWSx3QkN0QmhCLFNBQVM2QyxFQUFhQyxHQUVwQixPQURvQixJQUFJcEYsRUFBS29GLEVBSEYsaUJBRzhCQyxHQUN0Q0YsY0FDckIsQ0FFQSxNQUFNRyxFQUFVLElDbEJULE1BQ0xyRixZQUFZLEVBQXFCc0YsR0FBbUIsSUFBeEMsTUFBRUMsRUFBSyxTQUFFQyxHQUFVLEVBQzdCOUUsS0FBSytFLE9BQVNGLEVBQ2Q3RSxLQUFLZ0YsVUFBWUYsRUFFakI5RSxLQUFLaUYsV0FBYTdELFNBQVNsQixjQUFjMEUsRUFDM0MsQ0FDQU0sUUFBUUMsR0FDTm5GLEtBQUtpRixXQUFXRyxRQUFRRCxFQUMxQixDQUVBRSxTQUNFckYsS0FBSytFLE9BQU94QyxTQUFTK0MsSUFDbkJ0RixLQUFLZ0YsVUFBVU0sRUFBSyxHQUV4QixDQUVBQyxXQUFXSixHQUNUbkYsS0FBS2lGLFdBQVdPLE9BQU9MLEVBQ3pCLEdEQUEsQ0FDRU4sTURqQndCLENBQ3hCLENBQ0VwRixLQUFNLGtCQUNOQyxLQUFNLG9EQUVSLENBQ0VELEtBQU0sY0FDTkMsS0FBTSx1REFFUixDQUNFRCxLQUFNLGlCQUNOQyxLQUFNLDBEQUVSLENBQ0VELEtBQU0sVUFDTkMsS0FBTSxtREFFUixDQUNFRCxLQUFNLHdCQUNOQyxLQUFNLG1EQUVSLENBQ0VELEtBQU0saUJBQ05DLEtBQU0saURDTFJvRixTQUFXUSxJQUNUWCxFQUFRWSxXQUFXZixFQUFhYyxHQUFNLEdBRzFDLFVBR0ZYLEVBQVFVLFNBRVIsTUFBTUksRUFBVyxJRTVCVixNQUNMbkcsWUFBWSxHQUE2QyxJQUE3QyxvQkFBRW9HLEVBQW1CLG1CQUFFQyxHQUFvQixFQUNyRDNGLEtBQUs0RixhQUFleEUsU0FBU2xCLGNBQWN3RixHQUMzQzFGLEtBQUs2RixZQUFjekUsU0FBU2xCLGNBQWN5RixFQUU1QyxDQUVBRyxjQUNFLE1BQU8sQ0FDTHJHLEtBQU1PLEtBQUs0RixhQUFhcEYsWUFDeEJ1RixJQUFLL0YsS0FBSzZGLFlBQVlyRixZQUUxQixDQUVBd0YsWUFBWSxHQUFpQixJQUFqQixLQUFFdkcsRUFBSSxNQUFFd0csR0FBTyxFQUV6QmpHLEtBQUs0RixhQUFhcEYsWUFBY2YsRUFDaENPLEtBQUs2RixZQUFZckYsWUFBY3lGLENBQ2pDLEdGVTRCLENBQzVCUCxvQkFBcUIsa0JBQ3JCQyxtQkFBb0IsdUJBR2hCTyxFQUFhLElHakNaLGNBQTZCL0MsRUFDbENNLEtBQUswQyxFQUFNekcsR0FDVCxNQUFNMEcsRUFBVXBHLEtBQUtxRCxPQUFPbkQsY0FBYyx5QkFDcENtRyxFQUFRckcsS0FBS3FELE9BQU9uRCxjQUFjLHlCQUV4Q2tHLEVBQVE1RixZQUFjMkYsRUFDdEJFLEVBQU1DLElBQU01RyxFQUNaMkcsRUFBTUUsSUFBTSx5QkFDWnZHLEtBQUtPLE1BQVFiLEVBRWJ1RSxNQUFNUixNQUVSLEdIcUJvQyx1QkFDdEN5QyxFQUFXdkMsb0JBRVgsTUFBTTZDLEVBQVksSUFBSTFDLEVBQWMsdUJBQXdCd0IsR0FDMURHLEVBQVNPLFlBQVlWLEtBR3ZCa0IsRUFBVTdDLG9CQUVWLE1BQU04QyxFQUFlLElBQUkzQyxFQUFjLG9CQUFxQndCLElBQzFELE1BQ01vQixFQUFjbEMsRUFERixDQUFFL0UsS0FBTTZGLEVBQUssY0FBZTVGLEtBQU00RixFQUFLNUYsT0FFekRpRixFQUFRTyxRQUFRd0IsRUFBWSxJQUk5QkQsRUFBYTlDLG9CQUdiLE1BQU1nRCxFQUFxQnZGLFNBQVNsQixjQUFjLDZCQUM1QzBHLEVBQXFCeEYsU0FBU2xCLGNBQWMsMEJBRTVDMkcsRUFBb0IsSUFBSUMsRUFBY3hGLEVBQVVxRixHQUNoREksRUFBdUIsSUFBSUQsRUFBY3hGLEVBQVVzRixHQUV6REMsRUFBa0I1RCxtQkFDbEI4RCxFQUFxQjlELG1CQUtyQixNQUFNK0QsRUFBb0I1RixTQUFTbEIsY0FBYyx5QkFHM0MrRyxFQUFZN0YsU0FBU2xCLGNBQWMsMkJBQ25DZ0gsRUFBVzlGLFNBQVNsQixjQUFjLGlDQTJCeEMsU0FBU3dFLEVBQWdCakYsRUFBTUMsR0FDN0J3RyxFQUFXekMsS0FBS2hFLEVBQU1DLEVBQ3hCLENBeEJBc0gsRUFBa0J0RyxpQkFBaUIsU0FBUyxXQUMxQyxNQUFNNEUsRUFBT0csRUFBU0ssY0FDdEJVLEVBQVUvQyxPQUNWb0QsRUFBa0I3RCxrQkFDbEJpRSxFQUFVM0MsTUFBUWdCLEVBQUs3RixLQUN2QnlILEVBQVM1QyxNQUFRZ0IsRUFBS1MsR0FDeEIsSUFNdUIzRSxTQUFTbEIsY0FBYyxvQkFJL0JRLGlCQUFpQixTQUFTLFdBQ3ZDK0YsRUFBYWhELE9BQ2JzRCxFQUFxQi9ELGlCQUN2QixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgbGluayB9LCB0ZW1wbGF0ZUNhcmRTZWxlY3RvciwgaGFuZGxlckNhcmRDbGljaykge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX3RlbXBsYXRlQ2FyZFNlbGVjdG9yID0gdGVtcGxhdGVDYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVyQ2FyZENsaWNrID0gaGFuZGxlckNhcmRDbGljazsgXHJcbiAgICBcclxuXHJcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0ZW1wbGF0ZUNhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fY2FyZFwiKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlQnV0dG9uID0gKGUpID0+IHtcclxuICAgIGUudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkc19fYnV0dG9uLWxpa2VfYWN0aXZlXCIpO1xyXG4gIH07XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgIGNvbnN0IGxpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19idXR0b24tbGlrZVwiKTtcclxuICAgIGNvbnN0IHRyYXNoQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fYnV0dG9uLXRyYXNoXCIpO1xyXG4gICAgY29uc3QgY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKTtcclxuXHJcbiAgICBjYXJkSW1hZ2VFbC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dGhpcy5fbGlua30pYDtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICBsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKTtcclxuXHJcbiAgICB0cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICBjb25zdCBkZWxldGVDYXJkID0gZXZ0LnRhcmdldC5jbG9zZXN0KFwiLmNhcmRzX19jYXJkXCIpO1xyXG5cclxuICAgICAgZGVsZXRlQ2FyZC5yZW1vdmUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZXJDYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICBnZW5lcmF0ZUNhcmQgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2NhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9O1xyXG59XHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgdGhpcy5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcblxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXQsIGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3MgfSA9IHRoaXMuc2V0dGluZ3M7XHJcblxyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dCkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3MgfSA9IHRoaXMuc2V0dGluZ3M7XHJcblxyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvckNsYXNzKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICB9O1xyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0KSA9PiB7XHJcbiAgICBpZiAoaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXQsIGlucHV0LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0U2VsZWN0b3IgfSA9IHRoaXMuc2V0dGluZ3M7XHJcblxyXG4gICAgIHRoaXMuaW5wdXRMaXN0ID0gWy4uLnRoaXMuZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChpbnB1dFNlbGVjdG9yKV1cclxuXHJcbiAgICB0aGlzLmlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICBfaXNWYWxpZCA9ICgpID0+IHRoaXMuaW5wdXRMaXN0LmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUgPSAoKSA9PiB7XHJcbiAgICBjb25zdCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MsIHN1Ym1pdEJ1dHRvblNlbGVjdG9yIH0gPSB0aGlzLnNldHRpbmdzO1xyXG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgICBpZiAodGhpcy5faXNWYWxpZCgpKSB7XHJcbiAgICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IFwiZGlzYWJsZWRcIjtcclxuICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9XHJcbiAgfTtcclxuICBcclxuICByZXNldFZhbGlkYXRpb24oKXtcclxuICAgIHRoaXMuaW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICB9KVxyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xyXG4gICAgXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyh0aGlzLnNldHRpbmdzLCB0aGlzLmZvcm1FbGVtZW50KTtcclxuICB9XHJcbn1cclxuIFxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG5cclxuXHJcbiIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxjdG9yKTtcclxuICAgIHRoaXMuY2xvc2UgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmNsb3NlQnlFc2NhcGUgPSB0aGlzLmNsb3NlQnlFc2NhcGUuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2xpbmsgPSAnJztcclxuICB9XHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAgdGhpcy5jbG9zZUJ5RXNjYXBlKTtcclxuICAgIFxyXG4gICAgXHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLmNsb3NlQnlFc2NhcGUpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGNsb3NlQnlFc2NhcGUoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsIlxyXG5pbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBzdWJtaXRIYW5kbGVyKSB7XHJcbiAgICBcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc3VibWl0aGFuZGxlciA9IHN1Ym1pdEhhbmRsZXI7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKVxyXG4gIFxyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fVxyXG4gICAgY29uc3QgaW5wdXRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIildXHJcblxyXG4gICAgaW5wdXRzLmZvckVhY2goaW5wdXQgPT57XHJcbiAgICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIFxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXNcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fc3VibWl0aGFuZGxlcih0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIGNsb3NlICgpIHtcclxuICAgIFxyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG5cclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG59XHJcbiIsIlxyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXHJcbiAgICB9LFxyXG4gIF07XHJcblxyXG4gIGV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuICAgIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiLFxyXG4gIH07IiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5cclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7IGluaXRpYWxDYXJkcywgc2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG4vL2NvbnN0IGltYWdlQ2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzXCIpO1xyXG5jb25zdCBjYXJkVGVtcGxhdGVTZWxlY3RvciA9IFwiLmNhcmQtdGVtcGxhdGVcIjtcclxuXHJcbmZ1bmN0aW9uIGdlbmVyYXRlQ2FyZChjYXJkKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChjYXJkLCBjYXJkVGVtcGxhdGVTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2VuZXJhdGVDYXJkKCk7XHJcbn1cclxuXHJcbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgIHNlY3Rpb24uYXBwZW5kSXRlbShnZW5lcmF0ZUNhcmQoZGF0YSkpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmNhcmRzXCJcclxuKTtcclxuXHJcbnNlY3Rpb24ucmVuZGVyKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgcHJvZmlsZU5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBwcm9maWxlSm9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIsXHJcbn0pO1xyXG5cclxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5wb3B1cF90eXBlX3ByZXZpZXdcIik7XHJcbmltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfcHJvZmlsZVwiLCAoZGF0YSkgPT5cclxuICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKVxyXG4pO1xyXG5cclxuZWRpdE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF90eXBlX2NhcmRcIiwgKGRhdGEpID0+IHtcclxuICBjb25zdCBjYXJkSW5wdXQgPSB7IG5hbWU6IGRhdGFbXCJwbGFjZS1uYW1lXCJdLCBsaW5rOiBkYXRhLmxpbmsgfTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGdlbmVyYXRlQ2FyZChjYXJkSW5wdXQpO1xyXG4gIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgXHJcbn0pO1xyXG5cclxuYWRkQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5cclxuY29uc3QgcHJvZmlsZUZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV90eXBlX3Byb2ZpbGVcIik7XHJcbmNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1fdHlwZV9jYXJkXCIpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgcHJvZmlsZUZvcm1FbGVtZW50KTtcclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYWRkQ2FyZEZvcm1FbGVtZW50KTtcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS8vXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdCBwcm9maWxlXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuXHJcblxyXG5jb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX25hbWVcIik7XHJcbmNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdHlwZV9wcm9mZXNzaW9uXCIpO1xyXG5cclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS8vXHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gIGNvbnN0IGRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGVkaXRNb2RhbC5vcGVuKCk7XHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gZGF0YS5uYW1lO1xyXG4gIGpvYklucHV0LnZhbHVlID0gZGF0YS5qb2I7XHJcbn0pO1xyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS8vXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWRkIGNhcmRzXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG5jb25zdCBhZGRDYXJkT3BlbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uXCIpO1xyXG5cclxuXHJcblxyXG5hZGRDYXJkT3BlbkJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gIGFkZENhcmRNb2RhbC5vcGVuKCk7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayhuYW1lLCBsaW5rKSB7XHJcbiAgaW1hZ2VNb2RhbC5vcGVuKG5hbWUsIGxpbmspO1xyXG59XHJcblxyXG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG5cclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoZGF0YSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihkYXRhKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICBhcHBlbmRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxufVxyXG4iLCJcclxuXHJcbmV4cG9ydCBjbGFzcyBVc2VySW5mbyAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZUpvYlNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVKb2JTZWxlY3Rvcik7XHJcbiAgICBcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGpvYjogdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuIFxyXG4gICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgb3Blbih0ZXh0LCBsaW5rKSB7XHJcbiAgICBjb25zdCBjYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcHJldmlldy10aXRsZVwiKTtcclxuICAgIGNvbnN0IGltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcHJldmlldy1pbWFnZVwiKTtcclxuXHJcbiAgICBjYXB0aW9uLnRleHRDb250ZW50ID0gdGV4dDsgXHJcbiAgICBpbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgaW1hZ2UuYWx0ID0gJ0ltYWdlIG9mIHNlbGVjdGVkIHRpbGUnO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcblxyXG4gICAgc3VwZXIub3BlbigpO1xyXG5cclxuICB9XHJcbn0gXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJ0ZW1wbGF0ZUNhcmRTZWxlY3RvciIsImhhbmRsZXJDYXJkQ2xpY2siLCJuYW1lIiwibGluayIsImUiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJsaWtlQnV0dG9uIiwidGhpcyIsIl9jYXJkRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ0cmFzaEJ1dHRvbiIsImNhcmRJbWFnZUVsIiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJfbGluayIsInRleHRDb250ZW50IiwiX25hbWUiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJldnQiLCJjbG9zZXN0IiwicmVtb3ZlIiwiX2hhbmRsZXJDYXJkQ2xpY2siLCJfY2FyZFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX3RlbXBsYXRlQ2FyZFNlbGVjdG9yIiwiZG9jdW1lbnQiLCJjb250ZW50Iiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsImlucHV0IiwiZXJyb3JNZXNzYWdlIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImVycm9yRWxlbWVudCIsImlkIiwiYWRkIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRTZWxlY3RvciIsImlucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImV2ZXJ5IiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uIiwiX2lzVmFsaWQiLCJkaXNhYmxlZCIsInJlc2V0VmFsaWRhdGlvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwicG9wdXBTZWxjdG9yIiwiX3BvcHVwIiwiY2xvc2UiLCJiaW5kIiwiY2xvc2VCeUVzY2FwZSIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjb250YWlucyIsImtleSIsIlBvcHVwV2l0aEZvcm0iLCJwb3B1cFNlbGVjdG9yIiwic3VibWl0SGFuZGxlciIsInN1cGVyIiwiX3N1Ym1pdGhhbmRsZXIiLCJfZm9ybSIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwidmFsdWUiLCJyZXNldCIsImdlbmVyYXRlQ2FyZCIsImNhcmQiLCJoYW5kbGVDYXJkQ2xpY2siLCJzZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsInJlbmRlciIsImRhdGEiLCJhcHBlbmRJdGVtIiwiYXBwZW5kIiwidXNlckluZm8iLCJwcm9maWxlTmFtZVNlbGVjdG9yIiwicHJvZmlsZUpvYlNlbGVjdG9yIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVKb2IiLCJnZXRVc2VySW5mbyIsImpvYiIsInNldFVzZXJJbmZvIiwiYWJvdXQiLCJpbWFnZU1vZGFsIiwidGV4dCIsImNhcHRpb24iLCJpbWFnZSIsInNyYyIsImFsdCIsImVkaXRNb2RhbCIsImFkZENhcmRNb2RhbCIsImNhcmRFbGVtZW50IiwicHJvZmlsZUZvcm1FbGVtZW50IiwiYWRkQ2FyZEZvcm1FbGVtZW50IiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJwcm9maWxlRWRpdEJ1dHRvbiIsIm5hbWVJbnB1dCIsImpvYklucHV0Il0sInNvdXJjZVJvb3QiOiIifQ==